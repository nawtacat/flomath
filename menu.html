<!-- /Users/leweling/Desktop/trash/jom/menu.html -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Florian Editor - Projects</title>
    <style>
        body {
            background-color: #1e1e1e;
            color: #cccccc;
            font-family: 'Segoe UI', sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 50px;
        }
        h1 { margin-bottom: 30px; }
        .project-list {
            width: 100%;
            max-width: 600px;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        .project-item {
            background: #252526;
            border: 1px solid #3e3e42;
            padding: 15px;
            border-radius: 4px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: background 0.2s;
        }
        .project-item:hover { background: #333; }
        .project-name { font-weight: bold; font-size: 16px; }
        .project-date { font-size: 12px; color: #888; }
        button {
            background-color: #007acc;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            margin-bottom: 20px;
        }
        button:hover { opacity: 0.9; }
    </style>
    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
</head>
<body>

    <h1>My Projects</h1>
    <button onclick="createNewProject()">+ New Project</button>
    <div id="project-list" class="project-list">Loading...</div>

    <script>
        const firebaseConfig = { apiKey: "AIzaSyAbnPpcIt88B0jIAoLUdC71zmQDvR_fdu8", authDomain: "physmathacademy-722b3.firebaseapp.com", databaseURL: "https://physmathacademy-722b3-default-rtdb.firebaseio.com", projectId: "physmathacademy-722b3", storageBucket: "physmathacademy-722b3.appspot.com", messagingSenderId: "1093640992262", appId: "1:1093640992262:web:35b1bf4d2364bcf745f587" };
        firebase.initializeApp(firebaseConfig);
        
        // Anonymous auth to ensure access
        firebase.auth().signInAnonymously().catch(console.error);

        const db = firebase.database();
        const listEl = document.getElementById('project-list');

        function loadProjects() {
            db.ref('projects').on('value', (snapshot) => {
                listEl.innerHTML = '';
                const data = snapshot.val();
                if (!data) {
                    listEl.innerHTML = '<div style="text-align:center; color:#666;">No projects found. Create one!</div>';
                    return;
                }
                
                Object.keys(data).forEach(key => {
                    const proj = data[key];
                    const div = document.createElement('div');
                    div.className = 'project-item';
                    div.onclick = () => window.location.href = `editor.html?project=${key}`;
                    
                    const dateStr = proj.lastModified ? new Date(proj.lastModified).toLocaleString() : 'Unknown date';
                    
                    div.innerHTML = `
                        <span class="project-name">${proj.name || 'Untitled'}</span>
                        <span class="project-date">${dateStr}</span>
                    `;
                    listEl.appendChild(div);
                });
            });
        }

        function createNewProject() {
            const name = prompt("Enter project name:", "New Video");
            if (!name) return;
            
            const newRef = db.ref('projects').push();
            newRef.set({
                name: name,
                created: firebase.database.ServerValue.TIMESTAMP,
                lastModified: firebase.database.ServerValue.TIMESTAMP
            }).then(() => {
                window.location.href = `editor.html?project=${newRef.key}`;
            });
        }

        loadProjects();
    </script>
</body>
</html>
